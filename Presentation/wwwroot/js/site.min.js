function RESTCALL(n,t,i,r,u,f,e,o,s){$.ajax({xhr:function(){enablespiner();var n=new window.XMLHttpRequest;return n.upload.addEventListener("progress",function(n){if($(".progress").show(),n.lengthComputable){var t=n.loaded/n.total;t=parseInt(t*100);$(".progress-bar").css("width",t+"%");$(".progress-bar").text(t+"%");t===100&&($(".progress").hide(),$(".progress-bar").css("width","0%"))}},!1),n},url:n,type:i,cache:!0,data:t,processData:u,enctype:s,contentType:r,beforeSend:function(n){n.setRequestHeader("XSRF-TOKEN",$('input:hidden[name="__RequestVerificationToken"]').val());(o!=""||o!=undefined)&&n.setRequestHeader("Authorization","Bearer "+o)},success:f,error:e})}function removefile(n){var i=n.target.name.trim(),t;if(selectedFile!=null){for(t=0;t<selectedFile.length;t++)if(selectedFile[t].name==i){selectedFile.splice(t,1);break}n.currentTarget.parentNode.remove()}}function ConvertDatetoString(n){var t=n.getMonth()+1,i=n.getDate();return t=t<10?0+t.toString():t,i=i<10?0+i.toString():i,n.getFullYear()+"-"+t+"-"+i}function enablespiner(n="Processing"){$(".progress").length==0&&(msg=alertify.message("<div class='progress' style='margin-bottom:10px;display:none'><div class='progress-bar' style='width:0%' role='progressbar' aria-valuemin='0' aria-valuemax='100'><\/div><\/div><div style='display:-webkit-box'>"+n+"&nbsp;<i style = 'display:block;' class= 'fas fa-circle-notch fa-2x fa-spin' ><\/i><\/div>",0))}function disablespinner(){$(".progress").length!=0&&msg.dismiss()}function EnableReqInput(){var n="#"+$("#type-select").val(),t=$("#type-select > option").each(function(t){var i="#"+$("#type-select > option")[t].value;n!=i&&($(i).hide(),$(i+' :input[type="number"]').each(function(n){$(i+' :input[type="number"]')[n].disabled=!0}),$(i+" select").each(function(n){$(i+" select")[n].disabled=!0}))});n=="#Yearly"&&$(n+" :input").each(function(t){$(n+" :input")[t].disabled=!1});$(n).show();$('input[name="sub-radio"]').each(function(n){var t;$('input[name="sub-radio"]')[n].checked?(t="."+$('input[name="sub-radio"]')[n].id,$(t+" :input").each(function(n){$(t+" :input")[n].disabled=!1}),$(t+" select").each(function(n){$(t+" select")[n].disabled=!1})):(t="."+$('input[name="sub-radio"]')[n].id,$(t+" :input").each(function(n){$(t+" :input")[n].disabled=!0}),$(t+" select").each(function(n){$(t+" select")[n].disabled=!0}))})}function EndInputEnabler(){$('input[name="end-select"]').each(function(n){var t;$('input[name="end-select"]')[n].checked?(t="."+$('input[name="end-select"]')[n].id,$(t+" :input").each(function(n){$(t+" :input")[n].disabled=!1})):(t="."+$('input[name="end-select"]')[n].id,$(t+" :input").each(function(n){$(t+" :input")[n].disabled=!0}))})}function GenarateCron(){var n="*1 *2 *3 *4 *5",t,i,u,r,f;if(n=n.replace("*1","0").replace("*2","0"),$('input[name="type-select"]:checked').val()=="Daily"||$("#type-select").val()=="Daily")$('input[name="sub-radio"]:checked').val()=="Every"?(i=$("#daily-occurence").val()!=""?"*/"+$("#daily-occurence").val():"*",n=n.replace("*3",i)):$('input[name="sub-radio"]:checked').val()=="Weekdays"&&(n=n.replace("*5","2-6"));else if($('input[name="type-select"]:checked').val()=="Weekly"||$("#type-select").val()=="Weekly")t="",$.each($("input[name='exampleCheck1']:checked"),function(){t=t+$(this).val()+","}),t=t.substr(0,t.length-1),t==""&&(t="1"),n=n.replace("*5",t);else if($('input[name="type-select"]:checked').val()=="Monthly"||$("#type-select").val()=="Monthly"){if($('input[name="sub-radio"]:checked').val()=="Day")i=$("#month").val()!=""?"*/"+$("#month").val():"*",u=$("#day").val()!=""?$("#day").val():"*",n=n.replace("*3",u).replace("*4",i);else if($('input[name="sub-radio"]:checked').val()=="Month"){r=$("#select-day-option").val();$("#select-day-option").val()=="L"&&(f=[1,3,5,7,8,10,12],r=f.indexOf($("#input-month").val())!=-1?31:$("#input-month").val()==2?28:30);var i=r!="L"&&r!=""?r:"*",u=$("#select-week-option").val()!=""?$("#select-week-option").val():"*",e=$("#input-month").val()!=""?"*/"+$("#input-month").val():"*";n=n.replace("*3",i).replace("*4",e).replace("*5",u)}}else($('input[name="type-select"]:checked').val()=="Yearly"||$("#type-select").val()=="Yearly")&&($("#year-day").val()!=""&&$("#year-day").val()!=undefined&&(n=n.replace("*3",$("#year-day").val())),$("#year-month").val()!=""&&$("#year-month").val()!=undefined&&(n=n.replace("*4",$("#year-month").val())));n=n.replace("*1","0").replace("*2","0").replace("*3","*").replace("*4","*").replace("*5","*");$("#CronExpression").val(n)}function AddItem(n){var t=$("#FilesRemoved").val();t==""||t==undefined?$("#FilesRemoved").val(n.target.name):$("#FilesRemoved").val(t+","+n.target.name);$(".removed").show();n.target.remove()}function bindButtonClick(){$(".reply, #addcomment").on("click",function(n){var i,r,t;n.preventDefault();i=$(this).closest("div.mycon");r=$(this).closest("div.parent");$('[name="Comment"]').length==value&&(i.append("<div class='card reply popup top-buffer' style='margin-left:24px'><div class='card-body'><textarea  id='Comment' name='Comment' class='note' required><\/textarea><input type='text' id='ParentId' name='ParentId' value='"+r.prop("id")+"'hidden required><input type='text' id='WorkOrderId' name='WorkOrderId' value='"+$("#WorkOrderId").val()+"'hidden required><input type='text' id='RepliedTo' name='RepliedTo' value='"+$(this).siblings(".CommentBy").val()+"'hidden required><button type='submit' class='btn btn-outline-primary btn-sm top-buffer'>Post<\/button><input type='button' id='close' class='btn btn-outline-danger ml-1 btn-sm top-buffer' value='Close' onclick='closePopUp();;'><\/div><\/div>"),t=document.getElementById("Comment"),t.scrollIntoView(),t.focus())})}function deleteProp(){var n=$("#LocationId").find(":selected").val();n!=""?alertify.confirm("Do you want to delete Location",function(){enablespiner("Deleting...");$.ajax({type:"POST",url:"/property/DeleteLocation",data:{Id:n},success:function(){disablespinner();alertify.success("Deleted Successfully");$("#LocationId").val("");$("#LocationId option[value="+n+"]").remove();$("#SubLocation").val("")},error:function(n){disablespinner();alertify.error(n.responseText)}})}):alertify.alert("Info","<p> Please Choose Location <\/p>")}function deleteAsset(){var n=$("#AssetId").find(":selected").val();n!=""?alertify.confirm("Do you want to delete Asset",function(){enablespiner("Deleting...");$.ajax({type:"POST",url:"/property/DeleteAsset",data:{Id:n},success:function(){disablespinner();alertify.success("Deleted Successfully");$("#AssetId option[value="+n+"]").remove();$("#Issues").val("")},error:function(n){disablespinner();alertify.error(n.responseText);$("#AssetId").val("")}})}):alertify.alert("Info","<p> Please Choose Asset <\/p>")}function ShowNewLocation(){var n=document.querySelector("#flexCheckDefault").checked;n?($("#new-location").show(),$("#available-location").hide(),$("#SubLocation").val(""),$("#LocationId").val("")):($("#new-location").hide(),$("#NewLocation").val(""),$("#available-location").show())}function ShowNewAsset(){var n=document.querySelector("#flexCheckDefault").checked;n?($("#new-asset").show(),$("#available-asset").hide(),$("#Issues").val(""),$("#AssetId").val("")):($("#new-asset").hide(),$("#NewAsset").val(""),$("#available-asset").show())}var d,datestring,arr,val,msg,isdownload;$(document).ready(function(){$(".select-mul").change(function(){$(".select-input").val($(this).val())})});$(document).ready(function(){$(".Photo").change(function(n){const t=n.target.files[0];if(t!=undefined){const n=new FileReader;var i="";n.onload=n=>{i=n.target.result,$(".photo_disp img").prop("src",i)};n.readAsDataURL(t);$(".browsebutton")[0].innerText="Selected";$(".photo_disp").show()}})});var file=null,selectedFile=[],imgDisphtml="",parent="<div class='customdisp attach'>";$(document).ready(function(){$(".File").change(function(n){if(file=n.target.files,file!=undefined){for(var t=0;t<file.length;t++){const n={maxSizeMB:1.6,maxWidthOrHeight:720,onProgress:Function,useWebWorker:!0};file[t].size/1024>3e3&&file[t].type.indexOf("image")!=-1?(enablespiner("Compressing"),imageCompression(file[t],n).then(function(n){var t=new File([n],n.name);selectedFile.push(t);disablespinner()})):selectedFile.push(file[t]);imgDisphtml+="<div class='photo_disp' style='display:inline-table;margin:5px;'><span class='OpenImageDisplayModal' style='word-break: break-word;'>";file[t].type.indexOf("image")!=-1&&(imgDisphtml+="<img class='zoom-img' data-original='"+URL.createObjectURL(event.target.files[t])+"' height='150' src='"+URL.createObjectURL(event.target.files[t])+"' width='200'>");imgDisphtml+=file[t].name+"<\/span> <input class='btn btn-sm btn-danger mt-1' onclick='removefile(event);' type = 'button' value = 'Delete'><\/div>"}parent!=""?($("#file_selected").append(parent+imgDisphtml),$("#file_selected").append("<\/div><p class='text-danger'>Photo uploads are not added until work order is saved.<\/p>")):$(".attach").append(imgDisphtml);bindZoomImg();parent="";imgDisphtml="";$("input[type=file]").replaceWith($("input[type=file]").val("").clone(!0))}})});$(".clear").click(function(){$("input[type=text]").val("")});d=new Date;datestring=ConvertDatetoString(d);$("#CreationEndDate").prop("max",datestring);$("#CreationStartDate").prop("max",datestring);($("#CreationEndDate").val()==""||$("#CreationEndDate").val()==undefined)&&$("#CreationEndDate").val(datestring);($("#DueDate").val()!=undefined||$("#DueDate").val()!="")&&$(".DueDatelabel").text($("#DueDate").val());$("#CreationEndDate").change(function(){$("#CreationStartDate").prop("max",$("#EndDate").val())});$('input[type="reset"]').click(function(){$(".wofilter :input").each(function(n){var t=$(".wofilter :input")[n];(t.type=="text"||t.type=="date")&&t.setAttribute("value","")});$(".mwofilter :input").each(function(n){var t=$(".mwofilter :input")[n];(t.type=="text"||t.type=="date")&&t.setAttribute("value","")});$("input[type=file]").replaceWith($("input[type=file]").val("").clone(!0));$("photo-display").prop("src","");$("#DueDate").prop("value","");selectedFile=[];$("#file_selected").load(location.href+" #file_selected>*","");$("input[type=checkbox]").prop("checked",!1);$(".photo_disp").hide();$("#Status").val("");$(".browsebutton")[0]!=undefined&&($(".browsebutton")[0].innerText="Browse");$("#Priority").val("");$(".primary_span").text("");$('input[type="submit"]').click()});arr=[];$(document).ready(function(){$('input[name$="SelectedProperty"]').on("change",function(){var n;$(this).prop("checked")==!0?(n=arr.lastIndexOf($(this).val()),n==-1&&arr.push($(this).val())):(n=arr.lastIndexOf($(this).val()),$('input[name$="PrimaryProperty"]:checked').val()==$(this).val()&&($(".primary_span").text(""),$('input[name$="PrimaryProperty"]:checked').prop("checked",!1)),arr.splice(n,1));$(".select-input").val(arr)})});$(function(){var n=$(".select-input ").val().split(",");$("input:checkbox[name=SelectedProperty]").each(function(t){n.indexOf($("input:checkbox[name=SelectedProperty]")[t].value)!=-1&&($("input:checkbox[name=SelectedProperty]")[t].checked=!0)});$("input:radio[name=PrimaryProperty]").val([$(".primary_span")[0].innerText]);$("input:radio[name=PrimaryProperty]").trigger("change")});$(document).ready(function(){$('input[name$="PrimaryProperty"]').on("change",function(){var n=arr.lastIndexOf($(this).val());n==-1&&(arr.push($(this).val()),$(this).closest("div").find('input[type="checkbox"]').prop("checked",!0),$(".select-input").val(arr));$(".primary_span").text($(this).val())})});$(".select-input").val()!=""&&$(".select-input").val()!=undefined&&(val=$(".select-input").val(),val.indexOf(",")!=-1?(val=val.split(","),arr=val):arr.push(val),$('input[name$="SelectedProperty"]').each(function(){arr.indexOf($(this).val())!=-1&&$(this).prop("checked",!0)}),$('input[name$="PrimaryProperty"]').each(function(){$(".primary_span").text().trim()==$(this).val()&&$(this).prop("checked",!0)}));msg=null;$(document).ready(function(){$("#adduser, #wocreate, #addprop, #wocreaterecurring").submit(function(n){var r,i,t;for(n.preventDefault(),$(this).is("#wocreaterecurring")&&GenarateCron(),r=$(this).attr("action"),i=new FormData(this),t=0;t<selectedFile.length;t++)i.append("File",selectedFile[t]);$(this).valid()&&($("form :input").prop("disabled",!0),RESTCALL(r,i,"POST",!1,!1,function(n){disablespinner();$("form :input").prop("disabled",!1);alertify.alert("Info","<p>"+n+"<\/p>",function(){$("input[type=reset]").click()})},function(n){disablespinner();$("input[type=password]").val("");$("form :input").prop("disabled",!1);var t=n.responseText.split("@");n.status==302?alertify.alert("Success","<p>"+t[1]+"<\/p>",function(){window.location.href=t[0]}):alertify.alert("Error","<p>"+n.responseText+"<\/p>",function(){})},""))})});$(function(){$("#commentpost, #commentpost1 ").submit(function(n){n.preventDefault();var t=$(this).attr("action"),i=$(this).attr("parent"),r=new FormData(this);$(this).valid()&&($("form :input").prop("disabled",!0),RESTCALL(t,r,"POST",!1,!1,function(n){disablespinner();n.indexOf("div")!=-1&&($(i).html(n),bindButtonClick(),$("#close").click(),$("form :input").prop("disabled",!1),$("#commentpost").length!=0&&document.getElementById("commentpost").reset(),$("#commentpost1").length!=0&&document.getElementById("commentpost1").reset(),alertify.alert("Info","<p>Updated Successfully<\/p>",function(){}))},function(n){disablespinner();$("form :input").prop("disabled",!1);alertify.alert("Error","<p>"+n.responseText+"<\/p>",function(){})}));n.stopPropagation();n.stopImmediatePropagation()})});$(document).ready(function(){$("#edituser, #editwo, #editworecurring").submit(function(n){var r,i,t;for(n.preventDefault(),$(this).is("#editworecurring")&&GenarateCron(),r=$(this).attr("action"),i=new FormData(this),t=0;t<selectedFile.length;t++)i.append("File",selectedFile[t]);$(this).valid()&&($("form :input").prop("disabled",!0),RESTCALL(r,i,"POST",!1,!1,function(n){disablespinner();$("form :input").prop("disabled",!1);alertify.alert("Info","<p>"+n+"<\/p>",function(){})},function(n){disablespinner();$("input[type=password]").val("");$("form :input").prop("disabled",!1);var t=n.responseText.split("@");n.status==302?alertify.alert("Success","<p>"+t[1]+"<\/p>",function(){window.location.href=t[0]}):alertify.alert("Error","<p>"+n.responseText+"<\/p>",function(){location.reload()})},""))})});$(document).ready(function(){$("#Role").change(function(){$(this).children("option:selected").val()=="Master Admin"?$(".mainprop").prop("hidden",!0):$(".mainprop").prop("hidden",!1)})});$(document).ready(function(){$("#FilterActive").on("change",function(n){console.log("called");console.log(n);$(this).prop("checked")==!0&&($(".wofilter").show(),$(".mwofilter").show())});$(".closefilter").click(function(){$("#FilterActive").prop("checked",!1);$(".wofilter").hide(100);$(".mwofilter").hide(100)})});$(document).ready(function(){$("#Export").change(function(){$('input[type="submit"]').click()})});$("#Cancel").click(function(){$(".pop-up").hide(100)});$(".edit-link").click(function(){$(".pop-up").show(100)});$(window).on("beforeunload",function(){isdownload?isdownload=!1:alertify.message("<div style='display:-webkit-box'>Processing &nbsp;<i style = 'display:block;' class= 'fas fa-circle-notch fa-2x fa-spin' ><\/i><\/div>",0)});$(window).on("unload",function(){this.disablespinner()});$(document).ready(function(){$("#LocationId").change(function(){enablespiner("Loading...");$.get("/Property/GetSubLocation?id="+$(this).val(),function(n){if($("#SubLocationId").html("<option value=''>Select Sublocation<\/option>"),n!=null||n!=undefined)for(var t=0;t<n.length;t++)$("#SubLocationId").append("<option value="+n[t].id+">"+n[t].propertyName+"<\/option>")});$.get("/Property/GetAsset?locId="+$(this).val(),function(n){if(disablespinner(),$("#ItemId").html("<option value=''>Select Item<\/option>"),n!=null||n!=undefined)for(var t=0;t<n.length;t++)$("#ItemId").append("<option value="+n[t].id+">"+n[t].propertyName+"<\/option>")})})});$(document).ready(function(){$("#ItemId").change(function(){enablespiner("Loading...");$.get("/WorkOrder/GetIssue?id="+$(this).val(),function(n){if(disablespinner(),$("#IssueId").html("<option value=''>Select Issue<\/option><option value='-1'>Other<\/option>"),n!=null||n!=undefined)for(var t=0;t<n.length;t++)$("#IssueId").append("<option value="+n[t].id+">"+n[t].propertyName+"<\/option>")})})});$(document).ready(function(){$("#PropertyId").change(function(){enablespiner("Loading...");$.get("/workorder/GetLocation?id="+$(this).val(),function(n){if(disablespinner(),$("#LocationId").html("<option value=''>Select Location<\/option>"),$("#SubLocationId").html("<option value=''>Select SubLocation<\/option>"),n!=null||n!=undefined)for(var t=0;t<n.length;t++)$("#LocationId").append("<option value="+n[t].id+">"+n[t].propertyName+"<\/option>")})})});$(document).ready(function(){$("#Category").change(function(){enablespiner("Loading...");var n=$(this).val();$.get("/WorkOrder/GetDataByCategory?category="+$(this).val(),function(t){var i,r,u;if(disablespinner(),t!=null||t!=undefined){$("#OptionId").html("<option value=''>Please Choose Option<\/option>");for(i in t){for(r="",i!=""&&(r+="<optgroup label='"+i+"'>"),u=0;u<t[i].length;u++)r+="<option value="+t[i][u].id,t[i][u].id==3&&n=="department"&&(r+=" selected "),r+=">"+t[i][u].propertyName+"<\/option>";i!=""&&(r+="<\/optgroup>");$("#OptionId").append(r)}}});$(this).val()=="department"||$(this).val()=="user"?$("#OptionId").prop("required",!0).prop("hidden",!1):$("#OptionId").removeProp("required").prop("hidden",!0)});($("#OptionId").val()==""||$("#OptionId").val()==undefined)&&$("#Category").trigger("change")});$("#history_button").click(function(n){n.preventDefault();enablespiner();var t=$(this).data("custom-value");$.get("/WorkOrder/GetHistory?entity=workorder&rowId="+t,function(n){$("#history").html(n);disablespinner()})});$(document).ready(function(){$("#type-select").change(function(){EnableReqInput()})});$('input[name="sub-radio"]').click(function(){EnableReqInput()});EnableReqInput();$(document).ready(function(){$('input[name="end-select"]').change(function(){EndInputEnabler()})});EndInputEnabler();$(document).ready(function(){$("#RecurringStartDate").on("change",function(){$("#RecurringEndDate").prop("min",$(this).val())})});isdownload=!1;$("a[name='exportlink']").click(function(){var n=this.href;event.preventDefault();alertify.confirm(this.innerText,"Export currently filtered list (all pages)?",function(){isdownload=!0;alertify.closeAll();window.location=n},function(){})});$(document).ready(function(){$("#IssueId").on("change",function(){$(this).val()=="-1"?($(".CustomIssueDiv").show(),$(".CustomIssueDiv").prop("required","true")):($(".CustomIssueDiv").hide(),$(".CustomIssueDiv").removeProp("required"))});$("#IssueId").trigger("change")});$(function(){bindButtonClick()});$(document).ready(function(){$("#dohiddenreset").click(function(){document.getElementById("search").value="";$("#form1").submit();$(".form2").submit()})});$(document).ready(function(){$(".room").click(function(){$.get("/Home/Sublocation?Id="+$(this).val(),function(n){$(".subloc").html(n)})})});$(document).ready(function(){$(".toggle").change(function(){var n=".false"+$(this).val(),t=".true"+$(this).val();$(this)[0].checked?($(n).prop("hidden",!1),$(t).prop("hidden",!0)):($(t).prop("hidden",!1),$(n).prop("hidden",!0))});$("#updatefeat").submit(function(n){n.preventDefault();var t=$(this).attr("action"),i=$(this).serialize();RESTCALL(t,i,"POST","application/x-www-form-urlencoded; charset=UTF-8",!0,function(n){alertify.alert("Info","<p>"+n+"<\/p>",function(){disablespinner()})},function(n){$(".features").html(n.responseText);alertify.alert("Error","<p> Some error Occured <\/p>",function(){disablespinner()})},"")})});